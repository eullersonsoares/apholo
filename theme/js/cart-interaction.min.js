/**
 * @theme Beach
 * @version 1.0.0
 * @author STG Consult
 * @site https://stgconsult.com.br/
 */

var t="/web_api/cart/";function c(){return document.querySelector("html").attributes["data-session"].value}function n(e){let t=document.createElement("li"),r=document.createElement("div"),c=document.createElement("div"),n=document.createElement("img"),i=document.createElement("div"),d=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div");return t.setAttribute("class","idx-"+e),t.setAttribute("id","cart-product"),r.setAttribute("id","id-product"),c.setAttribute("id","img"),n.setAttribute("src",""),n.setAttribute("alt","Imagem do produto"),i.setAttribute("id","text-product"),d.setAttribute("id","price-product"),o.setAttribute("id","board-product"),a.setAttribute("id","notify-status"),c.appendChild(n),t.appendChild(r),t.appendChild(c),t.appendChild(i),t.appendChild(d),t.appendChild(o),t.appendChild(a),t}function d(e){return"R$"+(parseInt(e.replace(/[^\d]/g,""))/100).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})}function o(){var o;fetch(`${t}${c()}`).then(e=>e.json()).then(e=>{o=e}).catch(e=>{alert(e)}),setTimeout(()=>{if(parseInt(o.length)>0){let t=document.querySelectorAll("ul#cart-products li#cart-product");if(t.length>0)for(r=0;r<t.length;r++)t[r].remove();for(i=0;i<o.length;i++){let e=document.querySelector("ul#cart-products"),t=document.querySelectorAll("ul#cart-products li#cart-product"),r=n(i);t.length!=o.length&&e.appendChild(r)}let c=document.querySelectorAll("#id-product"),a=document.querySelectorAll("ul#cart-products li#cart-product #img img"),u=document.querySelectorAll("ul#cart-products li#cart-product div#text-product"),s=document.querySelectorAll("ul#cart-products li#cart-product div#price-product"),l=document.querySelectorAll("ul#cart-products li#cart-product div#board-product");for(e=0;e<o.length;e++)c[e].innerHTML="<div>"+o[e].Cart.product_id+"</div><span>"+o[e].Cart.variant_id+"</span>",a[e].setAttribute("src",o[e].Cart.product_image.https),u[e].innerHTML=o[e].Cart.product_name,s[e].innerHTML=`<span id="qnt">${o[e].Cart.quantity}</span> X ${d(o[e].Cart.price)}`,l[e].innerHTML=`<div id="board-content"><span id="menos" onclick="removeProduct(this)" class="idx-${e}">-</span><input name="quant" class="text idx-${e}" size="1" type="text" value="${o[e].Cart.quantity}"><span id="mais" onclick="addProduct(this)" class="idx-${e}">+</span></div><div onclick="deleteProduct(this)" id="trash" class="idx-${e}"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd"><path d="M9 3h6v-1.75c0-.066-.026-.13-.073-.177-.047-.047-.111-.073-.177-.073h-5.5c-.066 0-.13.026-.177.073-.047.047-.073.111-.073.177v1.75zm11 1h-16v18c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-18zm-10 3.5c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm5 0c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm8-4.5v1h-2v18c0 1.105-.895 2-2 2h-14c-1.105 0-2-.895-2-2v-18h-2v-1h7v-2c0-.552.448-1 1-1h6c.552 0 1 .448 1 1v2h7z"/></svg></div>`}h(o.length),v(),l()},275)}async function a(e){let r=parseInt(e.classList[0].replace(/[^0-9]/g,"")),n=document.querySelector(`ul#cart-products li.idx-${r} div#id-product div`).innerHTML,i=document.querySelector(`ul#cart-products li.idx-${r} div#id-product span`).innerHTML,d=document.querySelector(`ul#cart-products li.idx-${r} div#board-content input`),o={method:"POST",body:'{"Cart":{"session_id":"'+c()+'","product_id":"'+n+'","quantity":"1","variant_id":"'+i+'"}}',headers:new Headers({"Content-Type":"application/json; charset=utf-8"})};console.log(`ID: ${n} | Variant: ${i}`),fetch(t,o).then(e=>e.json()).then(e=>{"Successful request"==p(r,e.causes)&&(d.value=parseInt(d.value)+1,document.querySelector(`ul#cart-products li.idx-${r} div#price-product span#qnt`).innerHTML=parseInt(d.value),v())}).catch(e=>{console.log(e)})}async function u(e){let r,n=e;fetch(`${t}${c()}`).then(e=>e.json()).then(e=>{r=e});let i=parseInt(n.classList[0].replace(/[^0-9]/g,"")),d=document.querySelector(`ul#cart-products li.idx-${i} div#id-product div`).innerHTML,o=document.querySelector(`ul#cart-products li.idx-${i} div#id-product span`).innerHTML,a=document.querySelector(`ul#cart-products li.idx-${i} div#board-content input`),u={method:"DELETE",headers:new Headers({"Content-Type":"application/json; charset=utf-8"})};parseInt(a.value)>1?fetch(`/web_api/carts/${c()}/${d}/${o}`,u).then(e=>e.json()).then(e=>{"Successful request"==p(i,e.causes)&&(u={method:"POST",body:'{"Cart":{"session_id":"'+c()+'","product_id":"'+d+'","quantity":"'+(parseInt(a.value)-1)+'","variant_id":"'+o+'"}}',headers:new Headers({"Content-Type":"application/json; charset=utf-8"})},fetch(t,u).then(e=>e.json()).then(e=>{"Successful request"==p(i,e.causes)&&(a.value=parseInt(a.value)-1,document.querySelector(`ul#cart-products li.idx-${i} div#price-product span#qnt`).innerHTML=parseInt(a.value),v())}).catch(e=>{console.log(e)}))}).catch(e=>{console.log(e)}):s(e)}async function s(e){let t=parseInt(e.classList[0].replace(/[^0-9]/g,"")),r=document.querySelector(`ul#cart-products li.idx-${t} div#id-product div`).innerHTML,n=document.querySelector(`ul#cart-products li.idx-${t} div#id-product span`).innerHTML,i={method:"DELETE",headers:new Headers({"Content-Type":"application/json; charset=utf-8"})};fetch(`/web_api/carts/${c()}/${r}/${n}`,i).then(e=>e.json()).then(e=>{"Successful request"==p(t,e.causes)&&(document.querySelector("ul#cart-products li.idx-"+t).remove(),h(),v())}).catch(e=>{console.log(e)})}function l(){let e=document.getElementById("cart-data"),t=document.querySelector("#cart-data .data-content"),r=window.screen.width;1!=e.style.opacity?(e.style.display="flex",setTimeout(()=>{e.style.opacity=1,e.style.zIndex=1e3,t.style.marginRight=0},100),setTimeout(()=>{document.querySelector("#cart-data").addEventListener("click",handleClickOutside,!1)},150)):(e.style.opacity=0,e.style.zIndex=-7,t.style.marginRight=r>1024?"-30%":"-85%",setTimeout(()=>{e.style.display="none"},350))}function p(e,t="undefined"){if("undefined"==t||""==t)return"Successful request";m(e,t)}function m(e,t){let r=document.querySelector(`ul#cart-products li.idx-${e} div#notify-status`);r.style.maxHeight="90px",r.style.padding="4px 5px",r.innerHTML=t,setTimeout(()=>{r.style.maxHeight="0px",r.style.padding="0",r.innerHTML=""},3500)}function h(e){document.querySelectorAll("ul#cart-products li#cart-product").length<1||e<1?(document.querySelector("div#info-message").classList="show",document.querySelector(".footer-preview-cart").classList="footer-preview-cart hide"):(document.querySelector("div#info-message").classList="hide",document.querySelector(".footer-preview-cart").classList="footer-preview-cart")}function v(){let e=[],r=0,n=0;fetch(`${t}${c()}`).then(e=>e.json()).then(t=>{if(t.length>0){for(e=t,i=0;i<e.length;i++)n+=parseInt(e[i].Cart.price.replace(/[^\d]/g,""))*parseInt(e[i].Cart.quantity)/100,r+=parseInt(e[i].Cart.quantity);document.querySelector("#cart-data .valor strong").innerHTML="R$"+n.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),document.querySelector('header [data-cart="amount"]').innerHTML=r}else document.querySelector('header [data-cart="amount"]').innerHTML="0"}).catch(e=>{console.log(e)})}